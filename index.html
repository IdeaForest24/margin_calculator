<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eBay íŒë§¤ ë§ˆì§„ ê³„ì‚°ê¸°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            background-color: #f9fafb;
            color: #374151;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px;
            background-color: white;
            min-height: 100vh;
        }
        
        .header {
            margin-bottom: 32px;
        }
        
        .header h1 {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 30px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 16px;
        }
        
        .header p {
            color: #6b7280;
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 32px;
        }
        
        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .input-section {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }
        
        .section {
            padding: 24px;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        
        .section.blue { background-color: #eff6ff; border-color: #dbeafe; }
        .section.orange { background-color: #fff7ed; border-color: #fed7aa; }
        .section.green { background-color: #f0fdf4; border-color: #bbf7d0; }
        .section.red { background-color: #fef2f2; border-color: #fecaca; }
        .section.yellow { background-color: #fffbeb; border-color: #fde68a; }
        .section.gray { background-color: #f9fafb; border-color: #e5e7eb; }
        
        .section-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
            font-size: 18px;
            font-weight: 600;
        }
        
        .section-header.blue { color: #1d4ed8; }
        .section-header.orange { color: #ea580c; }
        .section-header.green { color: #16a34a; }
        .section-header.red { color: #dc2626; }
        .section-header.yellow { color: #d97706; }
        .section-header.gray { color: #374151; }
        
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }
        
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group.full {
            grid-column: span 2;
        }
        
        @media (max-width: 768px) {
            .form-group.full {
                grid-column: span 1;
            }
        }
        
        label {
            font-size: 14px;
            font-weight: 500;
            color: #374151;
            margin-bottom: 8px;
        }
        
        input, select {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.2s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .help-text {
            font-size: 12px;
            color: #6b7280;
            margin-top: 4px;
        }
        
        .dimension-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 12px;
        }
        
        .info-box {
            font-size: 14px;
            color: #1d4ed8;
            background-color: #eff6ff;
            padding: 12px;
            border-radius: 6px;
            margin-top: 16px;
        }
        
        .calculate-btn {
            width: 100%;
            background: linear-gradient(to right, #2563eb, #16a34a);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .calculate-btn:hover {
            background: linear-gradient(to right, #1d4ed8, #15803d);
            transform: translateY(-1px);
        }
        
        .results-section {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            font-size: 14px;
        }
        
        .result-item.header {
            font-weight: 600;
            font-size: 16px;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 8px;
            margin-bottom: 8px;
        }
        
        .result-item.total {
            font-weight: 600;
            font-size: 18px;
            border-top: 1px solid #e5e7eb;
            padding-top: 8px;
            margin-top: 8px;
        }
        
        .result-item.sub {
            font-size: 12px;
            color: #6b7280;
            margin-left: 16px;
        }
        
        .text-red { color: #dc2626; }
        .text-green { color: #16a34a; }
        .text-blue { color: #2563eb; }
        .text-gray { color: #6b7280; }
        
        .hidden { display: none; }
        
        ul {
            list-style: none;
            padding-left: 0;
        }
        
        li {
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .icon {
            width: 20px;
            height: 20px;
            display: inline-block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                ğŸ“ˆ eBay íŒë§¤ ë§ˆì§„ ê³„ì‚°ê¸°
            </h1>
            <p>eBay ê¸€ë¡œë²Œ íŒë§¤ë¥¼ ìœ„í•œ ì¢…í•© ì›ê°€ ë° ë§ˆì§„ ê³„ì‚° ë„êµ¬ì…ë‹ˆë‹¤. ì œí’ˆ ì›ê°€ë¶€í„° ìµœì¢… íŒë§¤ê°€ê¹Œì§€ ëª¨ë“  ë¹„ìš©ì„ ê³„ì‚°í•©ë‹ˆë‹¤.</p>
        </div>

        <div class="main-grid">
            <!-- ì…ë ¥ í¼ -->
            <div class="input-section">
                <!-- ì œí’ˆ ì›ê°€ ì •ë³´ -->
                <div class="section blue">
                    <div class="section-header blue">
                        ğŸ“¦ ì œí’ˆ ì›ê°€ ì •ë³´
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="productCost">ì œí’ˆ ì›ê°€ (ì›) *</label>
                            <input type="number" id="productCost" placeholder="ì˜ˆ: 50000">
                        </div>
                        <div class="form-group">
                            <label for="supplierShipping">ë§¤ì…ì²˜ ë°°ì†¡ë¹„ (ì›)</label>
                            <input type="number" id="supplierShipping" placeholder="ì˜ˆ: 3000">
                        </div>
                    </div>
                </div>

                <!-- ìƒí’ˆ ì •ë³´ ë° ë°°ì†¡ -->
                <div class="section orange">
                    <div class="section-header orange">
                        ğŸšš ìƒí’ˆ ì •ë³´ ë° ë°°ì†¡
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="weight">ì‹¤ì œ ì¤‘ëŸ‰ (kg) *</label>
                            <input type="number" step="0.1" id="weight" placeholder="ì˜ˆ: 0.8">
                        </div>
                        <div class="form-group">
                            <label for="egsShipping">eGS ì°½ê³  ì…ê³ ë¹„ (ì›)</label>
                            <input type="number" id="egsShipping" value="3400" placeholder="3400">
                            <div class="help-text">GS25 ë°˜ê°’íƒë°° ìµœì €ìš”ê¸ˆ: 3,400ì›</div>
                        </div>
                    </div>
                    <div class="dimension-grid" style="margin-top: 16px;">
                        <div class="form-group">
                            <label for="length">ê°€ë¡œ (cm)</label>
                            <input type="number" id="length" placeholder="30">
                        </div>
                        <div class="form-group">
                            <label for="width">ì„¸ë¡œ (cm)</label>
                            <input type="number" id="width" placeholder="20">
                        </div>
                        <div class="form-group">
                            <label for="height">ë†’ì´ (cm)</label>
                            <input type="number" id="height" placeholder="20">
                        </div>
                    </div>
                    <div id="weightInfo" class="info-box hidden"></div>
                </div>

                <!-- eBay íŒë§¤ ì •ë³´ -->
                <div class="section green">
                    <div class="section-header green">
                        ğŸŒ eBay íŒë§¤ ì •ë³´
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="destination">ëª©ì ì§€ *</label>
                            <select id="destination">
                                <option value="">ëª©ì ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                                <option value="US">ë¯¸êµ­ (US)</option>
                                <option value="CA">ìºë‚˜ë‹¤ (CA)</option>
                                <option value="GB">ì˜êµ­ (GB)</option>
                                <option value="DE">ë…ì¼ (DE)</option>
                                <option value="AU">í˜¸ì£¼ (AU)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="category">eBay ì¹´í…Œê³ ë¦¬ *</label>
                            <select id="category">
                                <option value="">ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                                <option value="most_categories">ëŒ€ë¶€ë¶„ ì¹´í…Œê³ ë¦¬ (ì¼ë°˜)</option>
                                <option value="books_movies_music">ë„ì„œ/ì˜í™”/ìŒì•…</option>
                                <option value="womens_bags">ì—¬ì„±ìš© ê°€ë°©/í•¸ë“œë°±</option>
                                <option value="athletic_shoes">ìš´ë™í™” (ë‚¨ì„±/ì—¬ì„±)</option>
                                <option value="jewelry_watches">ë³´ì„/ì‹œê³„ (ì¼ë°˜)</option>
                                <option value="watches_parts">ì‹œê³„/ë¶€í’ˆ/ì•¡ì„¸ì„œë¦¬</option>
                                <option value="coins_paper_money">ë™ì „/ì§€í (ê¸ˆê´´ì œì™¸)</option>
                                <option value="bullion">ê¸ˆê´´/ê·€ê¸ˆì†</option>
                                <option value="guitars_basses">ì•…ê¸° (ê¸°íƒ€/ë² ì´ìŠ¤)</option>
                                <option value="trading_cards">íŠ¸ë ˆì´ë”© ì¹´ë“œ</option>
                                <option value="nft_categories">NFT ì¹´í…Œê³ ë¦¬</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-grid" style="margin-top: 16px;">
                        <div class="form-group">
                            <label for="storeType">eBay ìŠ¤í† ì–´ êµ¬ë…</label>
                            <select id="storeType">
                                <option value="none">ìŠ¤í† ì–´ ì—†ìŒ/Starter</option>
                                <option value="basic">Basic ì´ìƒ ìŠ¤í† ì–´</option>
                            </select>
                            <div class="help-text">ìŠ¤í† ì–´ êµ¬ë… ì‹œ ìˆ˜ìˆ˜ë£Œ í• ì¸</div>
                        </div>
                        <div class="form-group">
                            <label for="isKoreanSeller">í•œêµ­ íŒë§¤ì ì—¬ë¶€</label>
                            <select id="isKoreanSeller">
                                <option value="true">í•œêµ­ íŒë§¤ì (VAT 10% ì ìš©)</option>
                                <option value="false">í•´ì™¸ íŒë§¤ì</option>
                            </select>
                            <div class="help-text">í•œêµ­ íŒë§¤ìëŠ” VAT 10% ì¶”ê°€</div>
                        </div>
                    </div>
                    <div class="form-group full" style="margin-top: 16px;">
                        <label for="targetMargin">ëª©í‘œ ë§ˆì§„ìœ¨ (%)</label>
                        <input type="number" step="1" id="targetMargin" value="30" placeholder="30">
                    </div>
                </div>

                <button class="calculate-btn" onclick="calculateMargin()">
                    ğŸ§® ë§ˆì§„ ê³„ì‚°í•˜ê¸°
                </button>
            </div>

            <!-- ê²°ê³¼ -->
            <div class="results-section">
                <div id="resultsContainer" class="hidden">
                    <!-- ë¹„ìš© êµ¬ì¡° -->
                    <div class="section red">
                        <div class="section-header red">
                            ğŸ’° ë¹„ìš© êµ¬ì¡° (ì›í™”)
                        </div>
                        <div id="costBreakdown"></div>
                    </div>

                    <!-- íŒë§¤ ì •ë³´ -->
                    <div class="section green">
                        <div class="section-header green">
                            ğŸ“ˆ íŒë§¤ ì •ë³´ (USD)
                        </div>
                        <div id="salesInfo"></div>
                    </div>

                    <!-- ì„¤ì • ì •ë³´ -->
                    <div class="section blue">
                        <div class="section-header blue">
                            âš™ï¸ íŒë§¤ ì„¤ì • ì •ë³´
                        </div>
                        <div id="settingsInfo"></div>
                    </div>
                </div>

                <!-- ì£¼ì˜ì‚¬í•­ -->
                <div class="section yellow">
                    <div class="section-header yellow">
                        âš ï¸ ì£¼ì˜ì‚¬í•­
                    </div>
                    <ul>
                        <li>â€¢ í™˜ìœ¨ì€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë³€ë™ë©ë‹ˆë‹¤ (í˜„ì¬ 1ë‹¬ëŸ¬=1,300ì› ê°€ì •)</li>
                        <li>â€¢ eBay ìˆ˜ìˆ˜ë£ŒëŠ” 2025ë…„ 2ì›” 14ì¼ ì´í›„ ìµœì‹  ìš”ê¸ˆí‘œ ê¸°ì¤€ì…ë‹ˆë‹¤</li>
                        <li>â€¢ ê±°ë˜ë‹¹ ìˆ˜ìˆ˜ë£Œ: $10 ì´í•˜ ì£¼ë¬¸ $0.30, $10 ì´ˆê³¼ ì£¼ë¬¸ $0.40</li>
                        <li>â€¢ í•œêµ­ íŒë§¤ìëŠ” eBay ìˆ˜ìˆ˜ë£Œì— VAT 10% ì¶”ê°€ ì ìš©ë©ë‹ˆë‹¤</li>
                        <li>â€¢ ìŠ¤í† ì–´ êµ¬ë… ì‹œ ìˆ˜ìˆ˜ë£Œ í• ì¸ì´ ì ìš©ë©ë‹ˆë‹¤</li>
                        <li>â€¢ í™˜ì „ ìˆ˜ìˆ˜ë£ŒëŠ” ë³„ë„ ê³„ì‚° (í˜ì´ì˜¤ë‹ˆì•„ ì •ì‚° ì‹œ ì•½ 3%)</li>
                        <li>â€¢ ë¶€í”¼ ì¤‘ëŸ‰ê³¼ ì‹¤ì œ ì¤‘ëŸ‰ ì¤‘ í° ê°’ìœ¼ë¡œ ê³¼ê¸ˆë©ë‹ˆë‹¤</li>
                        <li>â€¢ eGS ì°½ê³  ì…ê³ ë¹„ëŠ” GS25 ë°˜ê°’íƒë°° ê¸°ì¤€ì…ë‹ˆë‹¤</li>
                        <li>â€¢ ì‹¤ì œ íŒë§¤ ì‹œ ìµœì‹  ìš”ê¸ˆí‘œë¥¼ ë°˜ë“œì‹œ í™•ì¸í•˜ì„¸ìš”</li>
                    </ul>
                </div>

                <!-- ìˆ˜ì‹ ì„¤ëª… -->
                <div class="section gray">
                    <div class="section-header gray">
                        ğŸ“Š ê³„ì‚° ê³µì‹
                    </div>
                    <div style="font-size: 14px; color: #6b7280; line-height: 1.6;">
                        <div style="margin-bottom: 8px;"><strong>ì´ ì›ê°€:</strong> ì œí’ˆì›ê°€ + ë§¤ì…ì²˜ë°°ì†¡ë¹„ + eGSì°½ê³ ì…ê³ ë¹„ + eGSí•´ì™¸ë°°ì†¡ë¹„</div>
                        <div style="margin-bottom: 8px;"><strong>eBay ìˆ˜ìˆ˜ë£Œ:</strong> ì¹´í…Œê³ ë¦¬ë³„ ì°¨ë“± ì ìš© (2025.2.14 ì´í›„ ê¸°ì¤€)</div>
                        <div style="margin-left: 16px; font-size: 12px; margin-bottom: 8px;">
                            - ìŠ¤í† ì–´ ì—†ìŒ: ëŒ€ë¶€ë¶„ 13.6% + ê±°ë˜ë‹¹ ìˆ˜ìˆ˜ë£Œ<br>
                            - Basic ì´ìƒ: ëŒ€ë¶€ë¶„ 12.7% + ê±°ë˜ë‹¹ ìˆ˜ìˆ˜ë£Œ<br>
                            - ë³µì¡í•œ threshold êµ¬ì¡°ë„ ìë™ ê³„ì‚°
                        </div>
                        <div style="margin-bottom: 8px;"><strong>VAT:</strong> í•œêµ­ íŒë§¤ìëŠ” eBay ìˆ˜ìˆ˜ë£Œ Ã— 10%</div>
                        <div style="margin-bottom: 8px;"><strong>ê±°ë˜ë‹¹ ìˆ˜ìˆ˜ë£Œ:</strong> $10 ì´í•˜ $0.30, $10 ì´ˆê³¼ $0.40</div>
                        <div style="margin-bottom: 8px;"><strong>ê¶Œì¥ íŒë§¤ê°€:</strong> ë³µì¡í•œ ì—­ê³„ì‚°ìœ¼ë¡œ ì •í™•í•œ ëª©í‘œ ë§ˆì§„ ë‹¬ì„±</div>
                        <div style="margin-bottom: 8px;"><strong>ìˆœìˆ˜ìµ:</strong> íŒë§¤ê°€ - ì´ ì›ê°€ - eBay ìˆ˜ìˆ˜ë£Œ - VAT</div>
                        <div><strong>í™˜ì „ ìˆ˜ìˆ˜ë£Œ:</strong> ë³„ë„ ê´€ë¦¬ (í˜ì´ì˜¤ë‹ˆì•„ ì •ì‚° ì‹œ ì•½ 3%)</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // eBay ì¹´í…Œê³ ë¦¬ë³„ ìˆ˜ìˆ˜ë£Œìœ¨
        const ebayCategories = {
            'most_categories': { 
                name: 'ëŒ€ë¶€ë¶„ ì¹´í…Œê³ ë¦¬ (ì¼ë°˜)', 
                noStore: { rate: 13.6, threshold: 7500, overRate: 2.35 },
                withStore: { rate: 12.7, threshold: 2500, overRate: 2.35 }
            },
            'books_movies_music': { 
                name: 'ë„ì„œ/ì˜í™”/ìŒì•…', 
                noStore: { rate: 15.3, threshold: 7500, overRate: 2.35 },
                withStore: { rate: 15.3, threshold: 2500, overRate: 2.35 }
            },
            'womens_bags': { 
                name: 'ì—¬ì„±ìš© ê°€ë°©/í•¸ë“œë°±', 
                noStore: { rate: 15.0, threshold: 2000, overRate: 9.0 },
                withStore: { rate: 13.0, threshold: 2000, overRate: 7.0 }
            },
            'athletic_shoes': { 
                name: 'ìš´ë™í™” (ë‚¨ì„±/ì—¬ì„±)', 
                noStore: { rate: 8.0, minAmount: 150, belowMinRate: 13.6 },
                withStore: { rate: 7.0, minAmount: 150, belowMinRate: 12.7 }
            },
            'jewelry_watches': { 
                name: 'ë³´ì„/ì‹œê³„ (ì¼ë°˜)', 
                noStore: { rate: 15.0, threshold: 5000, overRate: 9.0 },
                withStore: { rate: 13.0, threshold: 5000, overRate: 7.0 }
            },
            'watches_parts': { 
                name: 'ì‹œê³„/ë¶€í’ˆ/ì•¡ì„¸ì„œë¦¬', 
                noStore: { rate: 15.0, threshold1: 1000, rate1: 6.5, threshold2: 7500, rate2: 3.0 },
                withStore: { rate: 12.5, threshold1: 1000, rate1: 4.0, threshold2: 5000, rate2: 3.0 }
            },
            'coins_paper_money': { 
                name: 'ë™ì „/ì§€í (ê¸ˆê´´ì œì™¸)', 
                noStore: { rate: 13.25, threshold: 7500, overRate: 2.35 },
                withStore: { rate: 9.0, threshold: 4000, overRate: 2.35 }
            },
            'bullion': { 
                name: 'ê¸ˆê´´/ê·€ê¸ˆì†', 
                noStore: { rate: 13.6, threshold: 7500, overRate: 7.0 },
                withStore: { rate: 7.5, threshold1: 1500, rate1: 5.0, threshold2: 10000, rate2: 4.5 }
            },
            'guitars_basses': { 
                name: 'ì•…ê¸° (ê¸°íƒ€/ë² ì´ìŠ¤)', 
                noStore: { rate: 6.7, threshold: 7500, overRate: 2.35 },
                withStore: { rate: 6.7, threshold: 2500, overRate: 2.35 }
            },
            'trading_cards': { 
                name: 'íŠ¸ë ˆì´ë”© ì¹´ë“œ', 
                noStore: { rate: 13.25, threshold: 7500, overRate: 2.35 },
                withStore: { rate: 12.35, threshold: 2500, overRate: 2.35 }
            },
            'nft_categories': { 
                name: 'NFT ì¹´í…Œê³ ë¦¬', 
                noStore: { rate: 5.0 },
                withStore: { rate: 5.0 }
            }
        };

        // eGS í•´ì™¸ë°°ì†¡ ìš”ê¸ˆí‘œ
        const egsRates = {
            US: [
                { weight: 0.1, price: 7100 }, { weight: 0.2, price: 8300 }, { weight: 0.3, price: 10100 },
                { weight: 0.4, price: 11900 }, { weight: 0.5, price: 13800 }, { weight: 0.6, price: 15300 },
                { weight: 0.7, price: 16300 }, { weight: 0.8, price: 17200 }, { weight: 0.9, price: 17800 },
                { weight: 1.0, price: 20400 }, { weight: 1.5, price: 25800 }, { weight: 1.6, price: 26400 },
                { weight: 1.7, price: 27000 }, { weight: 1.8, price: 27600 }, { weight: 1.9, price: 28600 },
                { weight: 2.0, price: 29700 }, { weight: 2.5, price: 36200 }, { weight: 3.0, price: 42700 }
            ],
            CA: [
                { weight: 0.1, price: 7200 }, { weight: 0.2, price: 8300 }, { weight: 0.3, price: 10000 },
                { weight: 0.4, price: 11300 }, { weight: 0.5, price: 12600 }, { weight: 0.6, price: 14400 },
                { weight: 0.7, price: 15400 }, { weight: 0.8, price: 16500 }, { weight: 0.9, price: 17600 },
                { weight: 1.0, price: 18600 }, { weight: 1.5, price: 24800 }, { weight: 1.6, price: 27800 },
                { weight: 1.7, price: 28800 }, { weight: 1.8, price: 29900 }, { weight: 1.9, price: 31000 },
                { weight: 2.0, price: 32000 }, { weight: 2.5, price: 37300 }, { weight: 3.0, price: 42600 }
            ],
            GB: [
                { weight: 0.1, price: 5700 }, { weight: 0.2, price: 7000 }, { weight: 0.3, price: 8200 },
                { weight: 0.4, price: 9400 }, { weight: 0.5, price: 10600 }, { weight: 0.6, price: 11900 },
                { weight: 0.7, price: 13100 }, { weight: 0.8, price: 14300 }, { weight: 0.9, price: 15500 },
                { weight: 1.0, price: 16700 }, { weight: 1.5, price: 22900 }, { weight: 1.6, price: 24100 },
                { weight: 1.7, price: 25300 }, { weight: 1.8, price: 26500 }, { weight: 1.9, price: 27700 },
                { weight: 2.0, price: 29000 }, { weight: 2.5, price: 35100 }, { weight: 3.0, price: 41200 }
            ],
            DE: [
                { weight: 0.1, price: 6900 }, { weight: 0.2, price: 7800 }, { weight: 0.3, price: 8700 },
                { weight: 0.4, price: 9600 }, { weight: 0.5, price: 10500 }, { weight: 0.6, price: 11600 },
                { weight: 0.7, price: 12500 }, { weight: 0.8, price: 13400 }, { weight: 0.9, price: 14300 },
                { weight: 1.0, price: 15200 }, { weight: 1.5, price: 19400 }, { weight: 1.6, price: 20300 },
                { weight: 1.7, price: 21100 }, { weight: 2.0, price: 23700 }, { weight: 2.5, price: 28100 },
                { weight: 3.0, price: 32500 }
            ],
            AU: [
                { weight: 0.2, price: 8100 }, { weight: 0.5, price: 11200 }, { weight: 1.0, price: 16600 },
                { weight: 1.5, price: 21800 }, { weight: 2.0, price: 26100 }
            ]
        };

        const destinations = {
            US: 'ë¯¸êµ­', CA: 'ìºë‚˜ë‹¤', GB: 'ì˜êµ­', DE: 'ë…ì¼', AU: 'í˜¸ì£¼'
        };

        // ë¶€í”¼ ì¤‘ëŸ‰ ê³„ì‚°
        function calculateVolumetricWeight() {
            const length = parseFloat(document.getElementById('length').value) || 0;
            const width = parseFloat(document.getElementById('width').value) || 0;
            const height = parseFloat(document.getElementById('height').value) || 0;
            
            if (length && width && height) {
                return (length * width * height) / 6000;
            }
            return 0;
        }

        // ìµœì¢… ê³¼ê¸ˆ ì¤‘ëŸ‰ ê³„ì‚°
        function getFinalWeight() {
            const actualWeight = parseFloat(document.getElementById('weight').value) || 0;
            const volumetricWeight = calculateVolumetricWeight();
            return Math.max(actualWeight, volumetricWeight);
        }

        // eGS í•´ì™¸ë°°ì†¡ë¹„ ê³„ì‚°
        function calculateEgsShipping(targetWeight, destination) {
            const rates = egsRates[destination];
            if (!rates) return 0;

            const exactMatch = rates.find(rate => rate.weight === targetWeight);
            if (exactMatch) return exactMatch.price;

            const nextHigher = rates.find(rate => rate.weight > targetWeight);
            if (nextHigher) return nextHigher.price;

            const lastRate = rates[rates.length - 1];
            if (targetWeight > lastRate.weight) {
                const previousRate = rates[rates.length - 2] || lastRate;
                const weightDiff = targetWeight - lastRate.weight;
                const pricePerKg = (lastRate.price - previousRate.price) / (lastRate.weight - previousRate.weight);
                return Math.round(lastRate.price + (weightDiff * pricePerKg));
            }

            return 0;
        }

        // ì¹˜ìˆ˜ ì…ë ¥ ì‹œ ë¶€í”¼ ì¤‘ëŸ‰ ì •ë³´ ì—…ë°ì´íŠ¸
        function updateWeightInfo() {
            const volumetricWeight = calculateVolumetricWeight();
            const finalWeight = getFinalWeight();
            const weightInfo = document.getElementById('weightInfo');
            
            if (volumetricWeight > 0) {
                weightInfo.innerHTML = `ë¶€í”¼ ì¤‘ëŸ‰: ${volumetricWeight.toFixed(2)}kg | ê³¼ê¸ˆ ì¤‘ëŸ‰: ${finalWeight.toFixed(2)}kg`;
                weightInfo.classList.remove('hidden');
            } else {
                weightInfo.classList.add('hidden');
            }
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('length').addEventListener('input', updateWeightInfo);
            document.getElementById('width').addEventListener('input', updateWeightInfo);
            document.getElementById('height').addEventListener('input', updateWeightInfo);
            document.getElementById('weight').addEventListener('input', updateWeightInfo);
        });

        // ë§ˆì§„ ê³„ì‚°
        function calculateMargin() {
            const productCost = document.getElementById('productCost').value;
            const supplierShipping = document.getElementById('supplierShipping').value || 0;
            const weight = document.getElementById('weight').value;
            const destination = document.getElementById('destination').value;
            const category = document.getElementById('category').value;
            const egsShipping = document.getElementById('egsShipping').value || 3400;
            const targetMargin = document.getElementById('targetMargin').value;
            const storeType = document.getElementById('storeType').value;
            const isKoreanSeller = document.getElementById('isKoreanSeller').value === 'true';

            if (!productCost || !destination || !category || !weight) {
                alert('ëª¨ë“  í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const finalWeight = getFinalWeight();
            const egsShippingCost = calculateEgsShipping(finalWeight, destination);
            
            // ì´ ì›ê°€ ê³„ì‚° (ì›í™”)
            const totalCostKRW = 
                parseFloat(productCost) + 
                parseFloat(supplierShipping) + 
                parseFloat(egsShipping) + 
                egsShippingCost;

            // USD í™˜ìœ¨
            const exchangeRate = 1300;
            const totalCostUSD = totalCostKRW / exchangeRate;

            // ìŠ¤í† ì–´ êµ¬ë… ì—¬ë¶€ì— ë”°ë¥¸ ìˆ˜ìˆ˜ë£Œìœ¨ ì„ íƒ
            const categoryData = ebayCategories[category];
            const hasStore = storeType !== 'none';
            const feeStructure = hasStore ? categoryData.withStore : categoryData.noStore;
            
            // ê±°ë˜ë‹¹ ìˆ˜ìˆ˜ë£Œ
            let transactionFee = 0.40;
            
            // ë³µì¡í•œ eBay ìˆ˜ìˆ˜ë£Œ ê³„ì‚°
            let requiredSellingPriceUSD;
            let ebayFeeUSD;
            
            // ë°˜ë³µ ê³„ì‚°ìœ¼ë¡œ ì •í™•í•œ íŒë§¤ê°€ ë„ì¶œ
            const marginRate = parseFloat(targetMargin) / 100;
            let estimatedPrice = (totalCostUSD + 0.40) / (1 - marginRate - (feeStructure.rate / 100));
            
            for (let i = 0; i < 10; i++) {
                transactionFee = estimatedPrice <= 10 ? 0.30 : 0.40;
                
                if (feeStructure.threshold) {
                    // ì¼ë°˜ì ì¸ threshold ë°©ì‹
                    const baseRate = feeStructure.rate / 100;
                    const overRate = feeStructure.overRate / 100;
                    const threshold = feeStructure.threshold;
                    
                    if (estimatedPrice <= threshold) {
                        ebayFeeUSD = (estimatedPrice * baseRate) + transactionFee;
                        estimatedPrice = (totalCostUSD + transactionFee) / (1 - marginRate - baseRate);
                    } else {
                        const baseFee = threshold * baseRate;
                        const overFee = (estimatedPrice - threshold) * overRate;
                        ebayFeeUSD = baseFee + overFee + transactionFee;
                        estimatedPrice = (totalCostUSD + baseFee + transactionFee + (overRate * threshold)) / (1 - marginRate - overRate);
                    }
                } else {
                    // ë‹¨ìˆœí•œ ìˆ˜ìˆ˜ë£Œ
                    const rate = feeStructure.rate / 100;
                    ebayFeeUSD = (estimatedPrice * rate) + transactionFee;
                    estimatedPrice = (totalCostUSD + transactionFee) / (1 - marginRate - rate);
                }
            }
            
            requiredSellingPriceUSD = estimatedPrice;
            
            // VAT ê³„ì‚° (í•œêµ­ íŒë§¤ìë§Œ)
            const vatUSD = isKoreanSeller ? ebayFeeUSD * 0.1 : 0;
            const totalFeesUSD = ebayFeeUSD + vatUSD;
            
            // ì‹¤ì œ ìˆ˜ìµ ê³„ì‚°
            const netProfitUSD = requiredSellingPriceUSD - totalCostUSD - totalFeesUSD;
            const netProfitKRW = netProfitUSD * exchangeRate;
            
            // ì‹¤ì œ ë§ˆì§„ìœ¨
            const actualMarginRate = (netProfitUSD / requiredSellingPriceUSD) * 100;

            // ê²°ê³¼ í‘œì‹œ
            displayResults({
                productCost: parseFloat(productCost),
                supplierShipping: parseFloat(supplierShipping),
                egsShipping: parseFloat(egsShipping),
                egsInternationalShipping: egsShippingCost,
                totalCostKRW: totalCostKRW,
                totalCostUSD: totalCostUSD,
                requiredSellingPriceUSD: requiredSellingPriceUSD,
                ebayFeeUSD: ebayFeeUSD,
                vatUSD: vatUSD,
                totalFeesUSD: totalFeesUSD,
                netProfitUSD: netProfitUSD,
                netProfitKRW: netProfitKRW,
                actualMarginRate: actualMarginRate,
                finalWeight: finalWeight,
                volumetricWeight: calculateVolumetricWeight(),
                exchangeRate: exchangeRate,
                feeStructure: feeStructure,
                transactionFee: transactionFee,
                hasStore: hasStore,
                isKoreanSeller: isKoreanSeller,
                destination: destination,
                category: category
            });
        }

        function displayResults(results) {
            // ë¹„ìš© êµ¬ì¡°
            document.getElementById('costBreakdown').innerHTML = `
                <div class="result-item">
                    <span>ì œí’ˆ ì›ê°€:</span>
                    <span>${results.productCost.toLocaleString()}ì›</span>
                </div>
                <div class="result-item">
                    <span>ë§¤ì…ì²˜ ë°°ì†¡ë¹„:</span>
                    <span>${results.supplierShipping.toLocaleString()}ì›</span>
                </div>
                <div class="result-item">
                    <span>eGS ì°½ê³  ì…ê³ ë¹„:</span>
                    <span>${results.egsShipping.toLocaleString()}ì›</span>
                </div>
                <div class="result-item">
                    <span>eGS í•´ì™¸ë°°ì†¡ë¹„:</span>
                    <span>${results.egsInternationalShipping.toLocaleString()}ì›</span>
                </div>
                <div class="result-item total text-red">
                    <span>ì´ ì›ê°€:</span>
                    <span>${results.totalCostKRW.toLocaleString()}ì›</span>
                </div>
            `;

            // íŒë§¤ ì •ë³´
            document.getElementById('salesInfo').innerHTML = `
                <div class="result-item">
                    <span>í™˜ìœ¨:</span>
                    <span>1 USD = ${results.exchangeRate.toLocaleString()}ì›</span>
                </div>
                <div class="result-item">
                    <span>ì´ ì›ê°€:</span>
                    <span>$${results.totalCostUSD.toFixed(2)}</span>
                </div>
                <div class="result-item">
                    <span>eBay ìˆ˜ìˆ˜ë£Œ:</span>
                    <span>$${results.ebayFeeUSD.toFixed(2)}</span>
                </div>
                <div class="result-item sub">
                    <span>- í¼ì„¼íŠ¸ ìˆ˜ìˆ˜ë£Œ:</span>
                    <span>$${(results.ebayFeeUSD - results.transactionFee).toFixed(2)}</span>
                </div>
                <div class="result-item sub">
                    <span>- ê±°ë˜ë‹¹ ìˆ˜ìˆ˜ë£Œ:</span>
                    <span>$${results.transactionFee.toFixed(2)}</span>
                </div>
                ${results.isKoreanSeller ? `
                <div class="result-item">
                    <span>VAT (10%):</span>
                    <span>$${results.vatUSD.toFixed(2)}</span>
                </div>
                ` : ''}
                <div class="result-item text-red">
                    <span>ì´ ìˆ˜ìˆ˜ë£Œ:</span>
                    <span>$${results.totalFeesUSD.toFixed(2)}</span>
                </div>
                <div class="result-item total text-blue">
                    <span>ê¶Œì¥ íŒë§¤ê°€:</span>
                    <span>$${results.requiredSellingPriceUSD.toFixed(2)}</span>
                </div>
                <div class="result-item text-green">
                    <span>ìˆœìˆ˜ìµ:</span>
                    <span>$${results.netProfitUSD.toFixed(2)}</span>
                </div>
                <div class="result-item">
                    <span>ìˆœìˆ˜ìµ (ì›í™”):</span>
                    <span class="text-green">${results.netProfitKRW.toLocaleString()}ì›</span>
                </div>
                <div class="result-item text-green">
                    <span>ì‹¤ì œ ë§ˆì§„ìœ¨:</span>
                    <span>${results.actualMarginRate.toFixed(1)}%</span>
                </div>
            `;

            // ì„¤ì • ì •ë³´
            document.getElementById('settingsInfo').innerHTML = `
                <div style="font-size: 14px; line-height: 1.6;">
                    <div>ëª©ì ì§€: ${destinations[results.destination]}</div>
                    <div>ê³¼ê¸ˆ ì¤‘ëŸ‰: ${results.finalWeight}kg</div>
                    <div>ì¹´í…Œê³ ë¦¬: ${ebayCategories[results.category].name}</div>
                    <div>ìŠ¤í† ì–´ êµ¬ë…: ${results.hasStore ? 'Basic ì´ìƒ' : 'ì—†ìŒ/Starter'}</div>
                    <div>íŒë§¤ì ìœ í˜•: ${results.isKoreanSeller ? 'í•œêµ­ íŒë§¤ì (VAT 10%)' : 'í•´ì™¸ íŒë§¤ì'}</div>
                    <div style="font-size: 12px; margin-top: 8px; padding: 8px; background-color: #eff6ff; border-radius: 4px;">
                        ğŸ’¡ ìˆ˜ìˆ˜ë£Œìœ¨: ${results.feeStructure.rate}%
                        ${results.feeStructure.threshold ? ` (${results.feeStructure.threshold.toLocaleString()}ê¹Œì§€)` : ''}
                        ${results.isKoreanSeller ? ' + VAT 10%' : ''}
                    </div>
                </div>
            `;

            // ê²°ê³¼ ì»¨í…Œì´ë„ˆ í‘œì‹œ
            document.getElementById('resultsContainer').classList.remove('hidden');
        }
    </script>
</body>
</html>
