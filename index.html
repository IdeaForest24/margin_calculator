<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eBay 판매 마진 계산기 v2.2</title>

    <!-- CSS 파일 연결 -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/margin-calculator.css">
    <link rel="stylesheet" href="css/egs-rates.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                📈 eBay 판매 마진 계산기 <span class="version-badge">v2.2</span>
            </h1>
        </div>

        <!-- 탭 네비게이션 -->
        <div class="tabs">
            <button class="tab-link active" onclick="openTab(event, 'marginCalculator')">마진 계산기</button>
            <button class="tab-link" onclick="openTab(event, 'egsRates')">eGS 운임표</button>
        </div>

        <!-- ================================== -->
        <!--        마진 계산기 탭 콘텐츠         -->
        <!-- ================================== -->
        <div id="marginCalculator" class="tab-content active">
             <div class="top-bar">
                <div class="exchange-rate-info">
                    <div>
                        <span>💱 실시간 환율: </span>
                        <span class="rate" id="exchangeRateDisplay">1 USD = 로딩중...</span>
                        <span id="lastUpdated" class="text-gray"></span>
                    </div>
                    <button class="refresh-btn" onclick="fetchExchangeRate()">
                        <span id="refreshIcon">🔄</span> 갱신
                    </button>
                </div>
                
                <div class="data-management-section">
                    <div class="excel-upload-compact" id="uploadSection" onclick="document.getElementById('excelFile').click()">
                        <div class="upload-icon">📋</div>
                        <div class="upload-text">eGS 운임표 업로드</div>
                        <input type="file" id="excelFile" class="file-input" accept=".xlsx,.xls">
                    </div>
                    <button class="clear-data-btn" onclick="clearSavedRatesData()">운임표 삭제</button>
                </div>
            </div>
            <div id="uploadStatus" class="upload-status hidden"></div>

            <div class="main-grid">
                <div class="input-section">
                    <div class="section blue">
                        <div class="section-header blue">📦 제품 원가 정보</div>
                        <div class="form-grid">
                            <div class="form-group"><label for="productCost">제품 원가 (원)</label><input type="number" id="productCost"></div>
                            <div class="form-group"><label for="supplierShipping">매입처 배송비 (원)</label><input type="number" id="supplierShipping"></div>
                        </div>
                    </div>

                    <div class="section orange">
                        <div class="section-header orange">🚚 상품 정보 및 배송</div>
                        <div class="service-type-toggle">
                            <div class="service-type-option active" data-type="standard">🚛 eGS Standard</div>
                            <div class="service-type-option" data-type="express">✈️ eGS Express</div>
                        </div>
                        <div class="form-grid">
                            <div class="form-group"><label for="weight">실제 중량 (kg)</label><input type="number" step="0.1" id="weight" placeholder="예: 0.5"></div>
                            <div class="form-group"><label for="egsShipping">eGS 창고 입고비 (원)</label><input type="number" id="egsShipping" value="3400"><div class="help-text">GS25 반값택배 등</div></div>
                        </div>
                        <div class="dimension-grid" style="margin-top: 16px;">
                            <div class="form-group"><label for="length">가로 (cm)</label><input type="number" id="length"></div>
                            <div class="form-group"><label for="width">세로 (cm)</label><input type="number" id="width"></div>
                            <div class="form-group"><label for="height">높이 (cm)</label><input type="number" id="height"></div>
                        </div>
                        <div id="weightInfo" class="info-box hidden"></div>
                    </div>

                    <div class="section green">
                        <div class="section-header green">🌍 eBay 판매 정보</div>
                        <div class="form-grid">
                            <div class="form-group"><label for="destination">목적지 *</label><select id="destination"><option value="">선택</option><option value="US">미국</option><option value="CA">캐나다</option><option value="GB">영국</option><option value="DE">독일</option><option value="FR">프랑스</option><option value="IT">이탈리아</option><option value="ES">스페인</option><option value="EU">기타 유럽</option><option value="AU">호주</option></select></div>
                            <div class="form-group"><label for="category">eBay 카테고리 *</label><select id="category"><option value="">선택</option><option value="most_categories">대부분 카테고리</option><option value="books_movies_music">도서/영화/음악</option><option value="womens_bags">여성용 가방</option><option value="athletic_shoes">운동화</option><option value="jewelry_watches">보석/시계</option><option value="watches_parts">시계/부품</option><option value="coins_paper_money">동전/지폐</option><option value="bullion">금괴/귀금속</option><option value="guitars_basses">악기(기타/베이스)</option><option value="trading_cards">트레이딩 카드</option><option value="nft_categories">NFT</option></select></div>
                        </div>
                        <div class="form-grid" style="margin-top: 16px;">
                            <div class="form-group"><label for="storeType">eBay 스토어 구독</label><select id="storeType"><option value="none">없음/Starter</option><option value="basic">Basic 이상</option></select></div>
                            <div class="form-group"><label for="isKoreanSeller">판매자 위치</label><select id="isKoreanSeller"><option value="true">한국 (VAT 10%)</option><option value="false">해외</option></select></div>
                        </div>
                        <div class="form-group full" style="margin-top: 16px;"><label for="targetMargin">목표 마진율 (%)</label><input type="number" step="1" id="targetMargin" placeholder="예: 20"></div>
                    </div>
                    <button class="calculate-btn" onclick="calculateMargin()">🧮 마진 계산하기</button>
                </div>
                <div class="results-section">
                    <div id="resultsContainer" class="hidden">
                        <div class="section green"><div class="section-header green">📊 계산 결과 상세</div><div id="resultDetails"></div></div>
                        <div class="section blue"><div class="section-header blue">⚙️ 계산 설정 정보</div><div id="settingsInfo"></div></div>
                    </div>
                    <div id="usageGuide" class="section blue">
                        <div class="section-header blue">📖 사용 방법</div>
                        <ul>
                            <li>• <strong>1단계:</strong> eGS 운임표 엑셀 파일을 업로드하세요.</li>
                            <li>• <strong>2단계:</strong> 제품 정보(원가, 중량, 치수)를 입력하세요.</li>
                            <li>• <strong>3단계:</strong> 배송 목적지와 eBay 카테고리를 선택하세요.</li>
                            <li>• <strong>4단계:</strong> 목표 마진율을 설정하고 계산하기를 클릭하세요.</li>
                            <li>• 💡 <strong>v2.2 업데이트:</strong> 탭 기능 추가 및 코드 구조화</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- ================================== -->
        <!--         eGS 운임표 탭 콘텐츠         -->
        <!-- ================================== -->
        <div id="egsRates" class="tab-content">
            <div class="placeholder-section">
                <h2>🚧 eGS 운임표 기능</h2>
                <p>이 기능은 현재 준비 중입니다. 곧 추가될 예정입니다.</p>
            </div>
        </div>
    </div>

    <!-- 외부 JS 라이브러리 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <!-- JavaScript 파일 연결 -->
    <script src="js/main.js"></script>
    <script src="js/margin-calculator.js"></script>
    <script src="js/egs-rates.js"></script>
</body>
</html>
